<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Propriedades Rurais</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://unpkg.com/@mongodb-js/charts-embed-dom"></script>
</head>
<body>
    <header>
        <h1>Gestão de Propriedades Rurais</h1>
    </header>

    <main>
        <section class="top-section">
            <div class="form-container">
                <h2>Cadastrar/Atualizar Propriedade</h2>
                <form id="propriedadeForm">
                    <input type="hidden" id="propriedadeId">
                    <div class="form-group">
                        <label for="nome">Nome da Propriedade:</label>
                        <input type="text" id="nome" required>
                    </div>
                    <div class="form-group">
                        <label for="descricao">Descrição:</label>
                        <textarea id="descricao" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="areaHectares">Área (hectares ):</label>
                        <input type="number" id="areaHectares" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="culturaPrincipal">Cultura Principal:</label>
                        <input type="text" id="culturaPrincipal">
                    </div>
                    <div class="form-group">
                        <label for="tags">Tags (separadas por vírgula):</label>
                        <input type="text" id="tags">
                    </div>
                    
                    <div class="form-group">
                        <label for="searchLocation">Buscar Localização:</label>
                        <div class="input-with-button">
                            <input type="text" id="searchLocation" placeholder="Digite um endereço ou local...">
                            <button type="button" id="geocodeButton" class="icon-button"><i class="fas fa-search"></i></button>
                        </div>
                        <small id="map-instruction">Clique no mapa para selecionar a localização.</small>
                    </div>

                    <div class="form-group" style="display: none;">
                        <label>Latitude:</label>
                        <input type="text" id="latitude" readonly required>
                    </div>
                    <div class="form-group" style="display: none;">
                        <label>Longitude:</label>
                        <input type="text" id="longitude" readonly required>
                    </div>

                    <button type="submit">Salvar Propriedade</button>
                    <button type="button" id="cancelEdit" style="display: none;">Cancelar Edição</button>
                </form>
            </div>
            <div class="map-container">
                <h2>Mapa das Propriedades</h2>
                <div id="map"></div>
            </div>
        </section>

        <section class="list-section">
            <div class="list-header">
                <h2>Propriedades Cadastradas</h2>
                <div class="search-bar">
                    <input type="text" id="searchText" placeholder="Buscar por nome, descrição, cultura ou tags...">
                    <button type="button" id="searchButton">Buscar</button>
                </div>
            </div>
            <div id="propriedadesList" class="card-container"></div>
            <div class="pagination-controls">
                <button id="prevPageButton">Anterior</button>
                <span id="pageInfo">Página 1 de 1</span>
                <button id="nextPageButton">Próximo</button>
            </div>
        </section>

        <section class="dashboard-section">
            <h2>Dashboard com os Charts do Mongo</h2>
            <div id="dashboard-content" class="dashboard-content show">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total de Propriedades</h3>
                        <p id="total-propriedades">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Área Total (ha)</h3>
                        <p id="area-total">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Culturas Diferentes</h3>
                        <p id="culturas-diferentes">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Área Média (ha)</h3>
                        <p id="area-media">0</p>
                    </div>
                </div>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>Distribuição por Cultura Principal</h3>
                        <div id="chart-cultura" class="chart-container">
                            <div class="loading">Carregando gráfico...</div>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>Distribuição Geográfica das Propriedades</h3>
                        <div id="chart-mapa" class="chart-container">
                            <div class="loading">Carregando mapa...</div>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3>Maiores Propriedades</h3>
                        <div id="chart-tabela" class="chart-container">
                            <div class="loading">Carregando tabela...</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="neo4j-section">
            <h2>Relacionamentos de Culturas (Neo4J)</h2>
            <div id="relacionamentos-culturas-container" class="list-group"></div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Gestão de Propriedades Rurais</p>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <script src="script.js"></script>
</body>
</html>